<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ç”¨æˆ·ç§äººé¡µ</title>
    <link rel="stylesheet" href="css/amazeui.min.css">
    <link rel="stylesheet" href="css/app.css">
    <link rel="stylesheet" href="css/mycss.css"/>
    <link rel="stylesheet" href="css/user_personal.css">
</head>
<!--https://www.cnblogs.com/mr-amazing/p/5674188.html-->
<style type="text/css">
    .am-topbar .am-text-ir {
        display: block;
        margin-right: 10px;
        height: 55px;
        width: 140px;
        background: url(images/logo.png) no-repeat left center;
        -webkit-background-size: 125px 24px;
        background-size: 125px 24px;
    }
</style>
<script>
</script>
<body>
<div id="xs_login_output" style="display: none"></div>

<header>
    <div id="xs_header_back" class="am-topbar am-topbar-inverse">
        <nav >
            <span id="logo" class="am-topbar-brand">
                <a href="index.html" class="am-text-ir"></a>
                <!-- <img src="" alt="logo">logo -->
            </span>
            <button class="am-topbar-btn am-topbar-toggle am-btn am-btn-sm am-btn-secondary am-show-sm-only" data-am-collapse="{target: '#doc-topbar-collapse-2'}" style="margin-top: 10px;">
                <span class="am-sr-only">å¯¼èˆªåˆ‡æ¢</span>
                <span class="am-icon-bars"></span>
            </button>
            <div class="am-collapse am-topbar-collapse xs_text_center" id="doc-topbar-collapse-2">
                <!-- å¯¼èˆª style="display: none;"-->
                <div class="xs_nav_content nav_transition transition  "  id="xs_nav_content">
                    <ul class="am-nav am-nav-pills"  id="xs_header_nav">
                        <li><a href="index.html">é¦–é¡µ</a></li><!-- am-topbar-nav -->
                        <li><a href="discover.html">å‘ç°</a></li>
                        <li><a href="activity.html">æ´»åŠ¨</a></li>
                        <li><a href="Popular_list.html">æ¦œå•</a></li>
                        <li><a href="Popular_list_user.html">å¤§ä½¬</a></li>
                        <input type="text" class="am-form-field am-input-sm xs_none_input" placeholder="æœç´¢">
                    </ul>
                </div>
                <!-- æœç´¢æ¡†style="display:none" placeholder="è¯·æœç´¢â€¦â€¦"-->
                <div class="xs_serch_input  transition " id="xs_serch_input"  >
                    <form action="#" id="xs_header_serher">
                        <span class="am-icon-close am-icon-sm xs_input_close" id="xs_input_close" onclick="clk();"></span><!-- onkeyup="inutpSelect();"-->
                        <input type="text"  autofocus="autofocus" autocomplete="off"
                               id="xs_search_input"   style="outline:none;"><!--onkeyup="inutpSelect();"-->
                        <span class="am-icon-search am-icon-sm" id="xs_input_search"></span>
                        <!--æ·»åŠ åˆ¤æ–­ï¼Œå¦‚æœç´¢æ¡†æ— å€¼è¿™è°ƒç”¨clk()ï¼Œæœ‰å€¼è·³è½¬-->
                        <div id="search-content" class="search-content">
                            <div class="search-content-list">
                                 
                            </div>
                        </div>
                    </form>
                </div>
                <div class="am-topbar-right" id="xs_content_login_box">
                    <div class="am-topbar-right">

                        <div class="am-dropdown" id="xs_login_box" data-am-dropdown="{boundary: '.am-topbar'}"><!-- style="height: 55px;"-->
                            <!-- ç”¨æˆ·æœªç™»å½•æ˜¾ç¤º -->

                        </div>
                    </div>
                </div>
            </div>
        </nav>
    </div>

</header>
<div id="content" style="top: -20px;">
    <div id="xs_content_menu">
        <!-- ä¸‹é¢çš„max-widthæ§åˆ¶ä¸€è¡Œæœ‰å¤šå°‘å›¾ -->
        <div class="am-g am-g-fixed blog-fixed blog-content" style="max-width: 1130px;">
            <!--  am-figure è¿™ä¸ªä¼šclass ä¼šå‡ºç°å›¾ç‰‡æµè§ˆå™¨    -->
            <figure data-am-widget="figure" class="am  am-figure-default "   data-am-figure="{  pureview: 'true' }">
                <div class="container_area_left">
                    <div class="card_media">
                        <div class="card_center">
                            <a href=""><img src="images/04.jpg" alt=""></a>

                        </div>
                        <div class="presonal_info">
                            <a href="">usaaaå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•ŠerNAme</a>
                        </div>
                        <div class="position_info">
                            <a href="">asdasd</a>
                        </div>
                    </div>

                    <div class="personal_menu">
                        <ul class="menu_list">
                            <li class="menu_list_default ">

                                <a href="javascript:void(0);" class="myWork" >
                                    <i class="nowMyWork newList"></i>
                                    æˆ‘çš„ä½œå“
                                </a>
                            </li>
                            <li class="menu_list_default ">
                                <a href="javascript:void(0);" class="myInfo" >
                                    <i class="nowMyInfo "></i>
                                    æˆ‘çš„èµ„æ–™
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="container-area-right ">
                    <!--ä¸ªäººä½œå“-->
                    <div class="user_work_box">
                        <div class="tab_menu">
                            <div class="tab_menu_info">
                                <ul class="sort_show_wrap">
                                    <li>
                                        <span>åˆ†ç±»</span>
                                        <div class="sort_list_box work_sort_list">
                                            <a href="javascript:void (0);" class="current">
                                                å…¨éƒ¨
                                            </a>
                                        </div>
                                    </li>
                                    <li>
                                        <span>çŠ¶æ€</span>
                                        <div class="sort_list_box">
                                            <a href="javascript:void(0);" class="select_lookstate current_select_state" id="lookstate_0">
                                                å…¨éƒ¨
                                            </a>
                                            <a href="javascript:void(0);" id="lookstate_1" class="select_lookstate">å¾…å®¡æ ¸</a>
                                            <a href="javascript:void(0);" id="lookstate_2" class="select_lookstate">å·²é€šè¿‡</a>
                                            <a href="javascript:void(0);" id="lookstate_3" class="select_lookstate" title="æ¯æ—¥ä¸­åˆ12ç‚¹ä¸åˆå¤œ12ç‚¹å°†è‡ªåŠ¨æ¸…ç©ºè¯¥åˆ—è¡¨">å·²åˆ é™¤</a>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div id="container_box" class="work_list ">
                            <div class="selectAll">
                                    <input class="checkboxNow" value="chkall" type="checkbox" name="chkall" id="selectAll" >
                                <a id="delWorkList" href="javascript:void(0);" class="outPut">æ‰§è¡Œ</a>
                            </div>
                            <div id="container" class="outNoneText">
                                <!--æ­¤å¤„è¾“å‡ºä½œå“åˆ—è¡¨-->
                                <span class="null_images"></span>
                                <span class="work_null_tips">æ²¡æœ‰ä»»ä½•ä½œå“</span>
                            </div>

                            <div id="page3"><!--åˆ†é¡µé¡µç çš„æ˜¾ç¤º-->
                        </div>
                    </div>
                    </div>
                    <!--ä¸ªäººè®¾ç½®-->
                    <div class="bg_box_radius dsno">
                        <div class="tab_menu_user">
                            <ul class="tab_box">
                                <li class="User_current">ä¸ªäººèµ„æ–™</li>
                            </ul>
                        </div>
                        <div class="datum_item_box">
                            <div class="text_center">
                                <div class="user_avatars">
                                    <div class="opacity_layer">
                                        ä¿®æ”¹å¤´åƒ
                                    </div>
                                    <input type="file" class="upload_img"  id="userImg_file">
                                    <div class="userImg_box">
                                        <img id="userImg" src="images/05.jpg" alt="">
                                    </div>
                                </div>
                                <div class="user_name_box hover">
                                    <span class="user_text_center " id="username_update">ç”¨æˆ·å</span>
                                    <a href="javascript:void(0);" class="user_name_modify">ä¿®æ”¹1</a>
                                </div>
                                <div class="am-input-group input_name_box"  style="display: none;">
                                    <input type="text" class="am-form-field userName_input" autofocus="autofocus">
                                    <span class="am-input-group-btn">
                                        <button class="xs_btn_style am-btn am-btn-default userName_btn" type="button">ä¿å­˜</button>
                                    </span>


                                </div>
                                <span class="userName_tip dsno">asd</span>
                            </div>
                            <div class="datum_title_box">
                                åŸºæœ¬ä¿¡æ¯
                                <input type="button" class="btn_user_info_save" value="ä¿å­˜">
                            </div>
                            <div class="table_wrap">
                                <ul class="user_info_list">
                                    <li>
                                        <span class="user_info_title">æ‰‹æœº</span>
                                        <input type="text" class="user_info_input input_userPhon">
                                        <span  class="user_info_tip user_info_title input_userPhon_tip dsno">asd</span>
                                        <input type="hidden" class="input_userPhon_hidden">
                                    </li>
                                    <li>
                                        <span class="user_info_title">é‚®ç®±</span>
                                        <input type="text" class="user_info_input input_userEmail">
                                        <span  class="user_info_tip user_info_title input_userEmail_tip dsno ">asd</span>
                                        <input type="hidden" class="input_userEmail_hidden">
                                    </li>
                                    <li>
                                        <span class="user_info_title">å§“å</span>
                                        <input type="text" class="user_info_input input_actualName">
                                        <span  class="user_info_tip user_info_title dsno ">asd</span>
                                        <input type="hidden" class="input_actualName_hidden">
                                    </li>
                                    <li>
                                        <span class="user_info_title">æ ‡ç­¾</span>
                                        <input type="text" class="user_info_input input_userlabel">
                                        <span  class="user_info_tip user_info_title dsno ">asd</span>
                                        <input type="hidden" class="input_userlabel_hidden">
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                </div>
            </figure>
<!--<button id="asd">asd</button>-->

        </div>

        <div id="tips3" class="dsno"></div>
        <div id="allPage"></div>
    </div>
    <div id="xs_content_img_list" >
    </div>


    <script>
    </script>
</div>
<footer>
    <div class="am-g   blog-fixed">
        <div class="xs_bottom_logo"></div>
        <div class="xs_bottom_icon"><!--  xs_border_style-->
            <p>
                <a href="javacript:void(0);">
                    <span class="am-icon-qq am-icon-fw xs_bottom_icon_style xs_qq_ewm">
                        <i class="xs_qqicon_hover"></i>
                    </span>
                </a>
                <a href="javacript:void(0);">
                    <span class="am-icon-weixin am-icon-fw xs_bottom_icon_style xs_weixin_ewm">
                        <i class="xs_wxicon_hover"></i>
                </span></a>
            </p>
        </div>
    </div>
    <h1 class="hone" id="hiii">æ˜å¤©æŠŠåˆ†é¡µ  ç”¨å¥½ï¼Œå¹¶åˆ¶ä½œæœç´¢é¡µé¢</h1>

    <div class="blog-text-center">&copy;2018 Purple dandel. Licensed under MIT license. Made with love By LWXYFER</div>
</footer>
<!-- å›åˆ°é¡¶éƒ¨åŠŸèƒ½ -->
<div data-am-widget="gotop" class="am-gotop am-gotop-fixed xs_gotop">
    <a href="#top" title="å›åˆ°é¡¶éƒ¨">
        <span class="am-gotop-title">å›åˆ°é¡¶éƒ¨</span>
        <i class="am-icon-btn am-icon-rocket amdoc-totop xs_gotop_icon"></i>
    </a>
</div>

<!--[if (gte IE 9)|!(IE)]><!-->
<script src="js/jquery.min.js"></script>
<script src="js\jquery.cookie.js"></script>
<!--<![endif]-->
<!--[if lte IE 8 ]>
<script src="http://libs.baidu.com/jquery/1.11.3/jquery.min.js"></script>
<script src="http://cdn.staticfile.org/modernizr/2.8.3/modernizr.js"></script>
<script src="js/amazeui.ie8polyfill.min.js"></script>
<![endif]-->
<script src="js/amazeui.min.js"></script>
<script src="js/pinto.min.js"></script>
<script src="js/img.js"></script>
<script src="js/outList.js"></script>
<script src="js/drag.js"></script>
<script src="js/selectkey.js"></script>
<script  src="js/login.js"></script>
<script  src="js/commonJS.js"></script>
<!-- æ­¤å¤„æ˜¯æ¯ä¸ªé¡µé¢å‡ä¼šä½¿ç”¨åˆ°çš„js -->
<script type="text/javascript" src="js/amazeui.page.js"></script>

<script type="text/javascript">
    //è·å–urlä¼ å€¼
    var userIdValueUrl= GetQueryStringByUrl("userId");
    //ç™»å½•æ—¶ä¿å­˜çš„Id
    var userIdlocal=localStorage.getItem("userId");
    if(userIdValueUrl==null || userIdValueUrl!==userIdlocal){
        window.location.href="index.html";
        window.history.back(-1);
    }else {
        var localState= localStorage.getItem("loginState");
        var userToken="";
        var userInfo="";
        //tokenéªŒè¯
        //åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å‹¾é€‰è‡ªåŠ¨ç™»å½•
        if(localState==1){//å‹¾é€‰
            userToken=localStorage.getItem("Token");
            userInfo=localStorage.getItem("userInfo");
        }
        else if(cookState!=null && localState==2){
            userToken=$.cookie("Token");
            userInfo=$.cookie("userInfo");
        }
        $.ajax({
            url: "http://localhost:6992/api/LoginToken/token",
            type: "post",
            async: true,
            //data: _json, //ä¸èƒ½ç›´æ¥å†™æˆ {id:"123",code:"tomcat"}
            //dataType: "json",
            // contentType: "charset=utf-8",  ,"cat":Search
            data:{UserName:""+userInfo+"",Token:""+userToken+""},
            //cache: false,
            success: function (returndata) {
                if(returndata.suc==true){
                    GetUserInfoById(userIdValueUrl,1);
                    outSort(2);
                    var outPages=$("#page").text();
                    //ä½œå“åˆ—è¡¨è¾“å‡º
                    GetWorkInfoByUserIdForUserPersonal(1,1,0,3,0,outPages,1);
                    document.title = userInfo+"-ç”¨æˆ·ç§äººé¡µ-ğŸ±è’²";

                }else {
                    alert(returndata.mes);
                    window.location.href="index.html";
                    window.history.back(-1);
                }
            },
            error: function (returndata) { alert(returndata+"é”™è¯¯"); }
        });
    }
    $(function () {
    //     $(document).on('click', '#asd', function()
    //     {
    //         //åˆ é™¤æœåŠ¡å™¨ä¸Šæ—§ç”¨æˆ·å¤´åƒ
    //         var oldUserImg=$("#userImg").attr("src");
    //         //http://localhost:6992/Upload/userImg/d00d3800f99e48729aabacc63f0d3a56.png
    //         var delWorkId=oldUserImg.lastIndexOf("2/");
    //         var NowOldUserImg=oldUserImg.substring(delWorkId+1,oldUserImg.length);
    //
    //
    //         deleFiles(NowOldUserImg);
    //     });
        //æˆ‘çš„ä½œå“åˆ—è¡¨
        $(document).on('click', '.myWork', function() {
            $(".nowMyWork").addClass("newList");//é€‰æ‹©æˆ‘çš„ä½œå“
            $(".nowMyInfo").removeClass("newList");//é€‰æ‹©æˆ‘çš„èµ„æ–™
            $(".user_work_box").removeClass("dsno");//ä¸ªäººä½œå“
            $(".bg_box_radius").addClass("dsno");//ä¸ªäººè®¾ç½®
            var outPages=$("#page").text();//å½“å‰æ€»é¡µæ•°
            outLookWorkList();
        });//è·å–ç±»å‹
            $(document).on('click', '.work_sort', function() {
                $(".work_sort").removeClass('current');
                $(this).addClass('current');
                outLookWorkList()
            });//è·å–æŸ¥çœ‹çŠ¶æ€
            $(document).on('click', '.select_lookstate', function() {
                $(".select_lookstate").removeClass('current_select_state');
                $(this).addClass('current_select_state');
                outLookWorkList();
            });
            //æ‰¹é‡_é€‰æ‹©
            $("#selectAll").bind("click",function(){
                if($(this).prop("checked")){
                    $("input[type='checkbox']").not(this).prop("checked",true);
                }else{
                    $("input[type='checkbox']").not(this).prop("checked",false);
                }
            });
            //æ‰¹é‡åˆ é™¤_æŒ‰é’®delWorkList
            $(document).on('click', '#delWorkList', function() {
                var cks=document.getElementsByName("checkName");
                var str=[];
                for(i=0;i<cks.length;i++){
                    if(cks[i].checked){
                        str.push(cks[i].value)
                    }
                }
                console.log(str);
                delWorkPut(str);
                $("input[type='checkbox']").not(this).prop("checked",false);
                //lert(cks);
            });
            //æ‰¹é‡è¿˜åŸ
            $(document).on('click', '#revertWorkList', function() {
                var cks=document.getElementsByName("checkName");
                var str=[];
                for(i=0;i<cks.length;i++){
                    if(cks[i].checked){
                        str.push(cks[i].value)
                    }
                }
                console.log(str);
                revertWorkPut(str);
                $("input[type='checkbox']").not(this).prop("checked",false);
            });

            //å½“å‰é¡µç çš„è¾“å‡º
            $(document).on('click', '.clickPage', function() {
                alert($(".am-active").index());
                //è·å–å½“å‰é¡µç //ç±»å‹
                var currentPage=$(".am-active").index();//$(this).attr("data-page");
                outLookWorkList
                (currentPage);

            });
        //æˆ‘çš„èµ„æ–™åˆ—è¡¨
        $(document).on('click', '.myInfo', function() {
            $(".nowMyWork").removeClass("newList");//é€‰æ‹©æˆ‘çš„ä½œå“
            $(".nowMyInfo").addClass("newList");//é€‰æ‹©æˆ‘çš„èµ„æ–™
            $(".bg_box_radius").removeClass("dsno");//ä¸ªäººè®¾ç½®
            $(".user_work_box").addClass("dsno");//ä¸ªäººä½œå“
            GetAllUserInfoById(userIdValueUrl);
        });
        //ç”¨æˆ·åä¿®æ”¹boxæ˜¾ç¤º
        $(document).on('click', '.user_name_modify', function() {
            $(".input_name_box").toggle(700);
        });
        //ç”¨æˆ·åä¿®æ”¹
        $(document).on('click', '.userName_btn', function() {
            var nowUserName=$(".userName_input").val();
            var oldUserName=$("#username_update").text();
            if(nowUserName!==oldUserName && nowUserName!==""){
                updateUserInfo
                (userIdValueUrl,null,nowUserName,null,null,null,null);
                $("#username_update").html(nowUserName);
                $(".input_name_box").toggle(700);
                $(".userName_tip").addClass("dsno")
            }else {
                $(".userName_tip").removeClass("dsno").text("è¯·è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·å")
            }

        });
        $(document).on('click', '.btn_user_info_save', function(){
            var userPhon=$(".input_userPhon").val();
            var userPhon_hidden=$(".input_userPhon_hidden").val();
            var nowUserPhon="";
            var userEmail=$(".input_userEmail").val();
            var userEmail_hidden=$(".input_userEmail_hidden").val();
            var nowUserEmail="";
            var actualName=$(".input_actualName").val();
            var actualName_hidden=$(".input_actualName_hidden").val();
            var nowActualName="";
            var userlabel=$(".input_userlabel").val();
            var userlabel_hidden=$(".input_userlabel_hidden").val();
            var nowUserlabel="";
            if((/^1(3|4|5|7|8)\d{9}$/.test(userPhon))){//æ‰‹æœºåˆ¤æ–­
                if(userPhon!==userPhon_hidden){
                    nowUserPhon=userPhon;
                }
            }else {
                $(".input_userPhon_tip").removeClass("dsno").text("è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·")
            }//^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$
            if((/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(userEmail))) {//é‚®ç®±åˆ¤æ–­
                if(userEmail!==userEmail_hidden){
                    nowUserEmail=userEmail;
                }
            }else {
                $(".input_userEmail_tip").removeClass("dsno").text("è¯·è¾“å…¥æ­£ç¡®é‚®ç®±")
            }
            if(actualName!==actualName_hidden){
                nowActualName=actualName;
            }
            if(userlabel!==userlabel_hidden){
                nowUserlabel=userlabel;
            }
            updateUserInfo
            (userIdValueUrl,null,null,nowUserPhon,nowUserEmail,nowActualName,nowUserlabel)
        });

        //ç”¨æˆ·å¤´åƒæ›´æ”¹å¹¶åˆ é™¤ä¹‹å‰çš„
        $(document).on('change', '#userImg_file', function() {
            var fileM=document.querySelector("#userImg_file");
            //è·å–æ–‡ä»¶å¯¹è±¡ï¼Œfilesæ˜¯æ–‡ä»¶é€‰å–æ§ä»¶çš„å±æ€§ï¼Œå­˜å‚¨çš„æ˜¯æ–‡ä»¶é€‰å–æ§ä»¶é€‰å–çš„æ–‡ä»¶å¯¹è±¡ï¼Œç±»å‹æ˜¯ä¸€ä¸ªæ•°ç»„
            var fileObj = fileM.files[0];
            //åˆ›å»ºformdataå¯¹è±¡ï¼ŒformDataç”¨æ¥å­˜å‚¨è¡¨å•çš„æ•°æ®ï¼Œè¡¨å•æ•°æ®æ—¶ä»¥é”®å€¼å¯¹å½¢å¼å­˜å‚¨çš„ã€‚
            var formData = new FormData();
            formData.append('file', fileObj);
            $.ajax({
                url: "http://localhost:6992/api/Works/UserImgUpload",
                type: "post",
                dataType: "json",
                data: formData,
                async: false,
                cache: false,
                contentType: false,
                processData: false,
                success: function (returndata) {
                    if(returndata.errno===1){
                        alert(returndata.msg);
                    }else {
                        var userImgSrc=returndata.data;//å®Œæ•´è·¯å¾„
                        var relativePathSrc=returndata.relativePath;//ç›¸å¯¹è·¯å¾„
                        //åˆ é™¤æœåŠ¡å™¨ä¸Šæ—§ç”¨æˆ·å¤´åƒ
                        var oldUserImg=$("#userImg").attr("src");
                        //http://localhost:6992/Upload/userImg/d00d3800f99e48729aabacc63f0d3a56.png
                        var delWorkId=oldUserImg.lastIndexOf("2/");
                        var NowOldUserImg=oldUserImg.substring(delWorkId+1,oldUserImg.length);


                        deleFiles(NowOldUserImg);
                        //æœ¬åœ°æ›´æ–°ç”¨æˆ·å¤´åƒ
                        $('.userImg_personal').attr('src',userImgSrc);//æŠŠsrcå±æ€§æ›´æ”¹ä¸ºä¸Šä¼ å¤´åƒå®Œæ•´è·¯å¾„;
                        var localState= localStorage.getItem("loginState");//ç™»å½•çŠ¶æ€ï¼Œæ˜¯å¦è‡ªåŠ¨ç™»å½•
                        if(localState==1) {//åˆ¤æ–­ç”¨æˆ·ç™»å½•æ—¶æ˜¯å¦å‹¾é€‰è‡ªåŠ¨ç™»å½•
                            //å®¢æˆ·ç«¯ä¿å­˜ç”¨æˆ·å¤´åƒ
                            localStorage.setItem("userImg",relativePathSrc);//å¤´åƒ
                        }else {
                            $.cookie("userImg",relativePathSrc);
                        }
                        //æ•°æ®åº“æ›´æ–°ç”¨æˆ·ä¿¡æ¯
                        updateUserInfo
                        (userIdValueUrl,relativePathSrc,null,null,null,null,null);
                    }
                },
                error: function (returndata) { alert(returndata+"é”™è¯¯"); }
            });
        })
    });
    //å•ä¸ªåˆ é™¤ä½œå“
    function delWork(obj_id) {
        var delWorkIdAll=obj_id;//$(this).attr("id");
        var delWorkId=delWorkIdAll.lastIndexOf("\_");
        var nowdelWorkId=delWorkIdAll.substring(delWorkId+1,delWorkIdAll.length);
        delWorkPut(nowdelWorkId);
    }
    //åˆ é™¤æ‰§è¡Œbox
    function delWorkPut(obj) {
        //æ ¹æ®ç”¨æˆ·idè¾“å‡ºä½œå“åˆ—è¡¨
        var _list=[0];//æ­¤å¤„ä¸èƒ½ä¸ºç©º
        _list.push(obj);
        $.ajax({
            type: "post",
            url: "http://localhost:6992/api/Works/UpdateWorkIsDeleted",
            contentType: 'application/json',
            data:JSON.stringify(_list),
            success: function (returndata) {
                if(returndata.suc===true){
                    alert(returndata.mes);
                    outLookWorkList();
                }else {
                    alert(returndata.mes);
                }
            },
            error: function (returndata) { alert(returndata+"é”™è¯¯"); }
        });
    }
    //è¿˜åŸå•ä¸ªä½œå“
    function revertWork(obj_id) {
        var delWorkIdAll = obj_id;//$(this).attr("id");
        var delWorkId = delWorkIdAll.lastIndexOf("\_");
        var nowdelWorkId = delWorkIdAll.substring(delWorkId + 1, delWorkIdAll.length);
        revertWorkPut(nowdelWorkId)
    }
    //è¿˜åŸæ‰§è¡Œbox
    function revertWorkPut(obj_id){
        //æ ¹æ®ç”¨æˆ·idè¾“å‡ºä½œå“åˆ—è¡¨
        var _list = [0];
        _list.push(obj_id);
        $.ajax({
            type: "post",
            url: "http://localhost:6992/api/Works/UpdateWorkrevert",
            contentType: 'application/json',
            data: JSON.stringify(_list),
            success: function (returndata) {
                if (returndata.suc === true) {
                    alert(returndata.mes);
                    outLookWorkList();
                } else {
                    alert(returndata.mes);
                }
            },
            error: function (returndata) {
                alert(returndata + "é”™è¯¯");
            }
        });
    }
    //ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯
    function updateUserInfo
    (UserId,UserImg,UserName,UserPhone,Email,ActualName,Userlabel){
        $.ajax({
            url: "http://localhost:6992/api/UserInfo/UpdateUserInfoByUserId",
            type: "post",
            async: true,
            data:{
                UserId:UserId,
                UserName:UserName,
                ActualName:ActualName,
                Userlabel:Userlabel,
                UserPhone:UserPhone,
                Email:Email,
                UserImg:UserImg,
            },
            success: function (returndata){
                if(returndata.suc===false){
                    alert(returndata.mes);
                }
            },
            error: function (returndata) { alert(returndata+"é”™è¯¯"); }
        });

    }
    //åˆ é™¤ä¸Šä¼ çš„æ–‡ä»¶
    function deleFiles(fileUrl){
        var imgUrl=fileUrl+"";
        $.ajax({
            url: "http://localhost:6992/api/Works/DeleFiles",
            type: "get",
            dataType: "json",
            data: {fileUrl:imgUrl},
            async: true,

            success: function (returndata){
            },
            error: function (returndata) { alert(returndata+"é”™è¯¯"); }
        });
    }
    window.onload = function () {
        outLoginBox();//è¾“å‡ºç™»å½•dom
        loginBox();//è¾“å‡ºheaderç™»å½•çŠ¶æ€
        //ç™»å½•æ¨¡å—æ•ˆæœ
        $(".xs_login_mark").on('click',function(){
            $(".xs_login_mark").removeClass('xs_content_current');
            $(this).addClass('xs_content_current');
            if($('.xs_login_display').hasClass('dsno')){
                $('.xs_login_display').removeClass('dsno');
                $(".xs_login_display").addClass('dsbl');
            }
            else if($('.xs_login_display').hasClass('dsbl')){
                $('.xs_login_display').removeClass('dsbl');
                $(".xs_login_display").addClass('dsno');
            }
            if($('.password').hasClass('dsbl')){//æ‰‹æœºç™»å½•
                $('.password').removeClass('dsbl');
                $(".password").addClass('dsno');//ä¸æ˜¾ç¤º
                $("#xs_password").val("");
                $('#login_btn').attr({"disabled":"disabled"});//ç¦ç”¨
                $('.xs_error_tips').addClass('dsno');
            }else{
                $('.password').removeClass('dsno');//å¯†ç ç™»å½•
                $("#xs_password").val("");
                $(".password").addClass('dsbl');//æ˜¾ç¤º
                $('.xs_error_tips').addClass('dsno');
                $('#login_btn').attr({"disabled":"disabled"});//ç¦ç”¨
            }
            $('#drag').drag();//æ»‘åŠ¨è¦æ”¾åœ¨ç™»å½•æ¨¡å—æ˜¯å¦æ˜¾ç¤ºä¹‹å
        });
        $('.btn-loading-example').click(function () {
            var loginState=$(".xs_content_current").attr("id");
            var str=loginState.lastIndexOf("\_");
            var newState=loginState.substring(str+1,loginState.length);
            var login_btn=$('#login_btn');
            if(newState==0){//ç”¨æˆ·å¯†ç 
                var userName=$.trim($('#xs_username').val());//ç”¨æˆ·åæˆ–æ‰‹æœº
                var password=$.trim($('#xs_password').val());//ç”¨æˆ·å¯†ç 
                if(userName!=""&&password!=""){
                    var $btn = $(this)
                    $btn.button('loading');
                    setTimeout(function(){
                        $btn.button('reset');//
                    }, 500);
                    namePwd_login(userName,password);
                }else{
                    $('.xs_errpr_text ').text("æ‰€å¡«å€¼ä¸èƒ½ä¸ºç©º");
                    $('.xs_error_tips').removeClass('dsno');
                    login_btn.attr({"disabled":"disabled"});
                    return;
                }
            }
            if(newState==1){//æ‰‹æœºéªŒè¯
                var userName=$.trim($('#xs_username').val());//ç”¨æˆ·åæˆ–æ‰‹æœº
                var smsCd=$.trim($('#sms-cd').val());//éªŒè¯ç 
                if(userName!=""&&smsCd!=""){//æ‰‹æœºç™»å½•
                    var $btn = $(this);
                    $btn.button('loading');
                    setTimeout(function(){
                        $btn.button('reset');
                    }, 500);
                    phone_login(userName,smsCd);
                }else{
                    $('.xs_errpr_text ').text("æ‰€å¡«å€¼ä¸èƒ½ä¸ºç©º");
                    $('.xs_error_tips').removeClass('dsno');
                    login_btn.attr({"disabled":"disabled"});
                    return;
                }
            }
        });
    };

    //åˆ†é é ç¢¼çš„è¼¸å‡º
    var clickPage;
    function outPage(e){
        if(e<=1){
            $("#page3").addClass("dsno");
        }
        else{
            $("#page3").removeClass("dsno");
            var pagesHtml=$("#page").text();
            if(e==pagesHtml){
                return false;
            }else{
                //oldPage=e;
                var str=e.toString();
                $("#page3").page({
                    pages:str,
                    first: false,//"é¦–é¡µ", //è®¾ç½®falseåˆ™ä¸æ˜¾ç¤ºï¼Œé»˜è®¤ä¸ºfalse
                    last: false,//"å°¾é¡µ", //è®¾ç½®falseåˆ™ä¸æ˜¾ç¤ºï¼Œé»˜è®¤ä¸ºfalse
                    prev: 'ï¼œ',//<ã€Š â–  Â«Â»â€¹â€ºâ—€â–¶â—â–·ï¹¤ï¹¥ï¼œï¼ //è‹¥ä¸æ˜¾ç¤ºï¼Œè®¾ç½®falseå³å¯ï¼Œé»˜è®¤ä¸ºä¸Šä¸€é¡µ
                    next: 'ï¼', //è‹¥ä¸æ˜¾ç¤ºï¼Œè®¾ç½®falseå³å¯ï¼Œé»˜è®¤ä¸ºä¸‹ä¸€é¡µ
                    groups: 3, //è¿ç»­æ˜¾ç¤ºåˆ†é¡µæ•°
                    jump:function(context){
                        $("#tips3").html("å…±"+context.option.pages+"é¡µï¼Œå½“å‰ç¬¬"+context.option.curr+"é¡µ");
                    }
                });
            }
        }
    }
    //è¾“å‡ºä½œå“åˆ—è¡¨
    function outLookWorkList(currentPage) {
        //å–åˆ°ä½œå“ç±»å‹
        var sort= $(".current").attr("id");
        var strSort=sort.lastIndexOf("\_");
        var strSortState=sort.substring(strSort+1,sort.length);
        //å–åˆ°ä½œå“æŸ¥çœ‹çŠ¶æ€
        var workStr= $(".current_select_state").attr("id");
        var workStrState=workStr.lastIndexOf("\_");
        var workStrStateInt=Number(workStr.substring(workStrState+1,workStr.length));
        var outPages=$("#page").text();//å½“å‰æ€»é¡µæ•°
        if(currentPage==null){
            currentPage=1;
        }
        switch (workStrStateInt) {
            case 0://å…¨éƒ¨
                GetWorkInfoByUserIdForUserPersonal
                (currentPage,userIdValueUrl,strSortState,3,0,outPages,1);
                $('.outPut').attr('id','delWorkList');
                break;
            case 1://å¾…å®¡æ ¸
                GetWorkInfoByUserIdForUserPersonal
                (currentPage,userIdValueUrl,strSortState,0,0,outPages,1);
                $('.outPut').attr('id','delWorkList');
                break;
            case 2://å·²é€šè¿‡
                GetWorkInfoByUserIdForUserPersonal
                (currentPage,userIdValueUrl,strSortState,1,0,outPages,1);
                $('.outPut').attr('id','delWorkList');
                break;
            case 3://å·²åˆ é™¤
                GetWorkInfoByUserIdForUserPersonal
                (currentPage,userIdValueUrl,strSortState,3,1,outPages,0);
                $('.outPut').attr('id','revertWorkList');
                break;
            default://å…¨éƒ¨
                GetWorkInfoByUserIdForUserPersonal
                (currentPage,userIdValueUrl,0,3,0,outPages,1);
                $('.outPut').attr('id','delWorkList');
                break;
        }
    }
</script>
<script>
</script>
</body>
</html>